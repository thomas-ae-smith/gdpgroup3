\section{Design}

\subsection{System Layers}
The user must be able to access the app via a web browser.

It was decided that the TV and programme streams should be delivered to the client via Wowza media server, which would be run on a Windows server. Peter Wood (inqb8r) has had extensive experience with Wowza, and was able promptly to have the server configured to stream, releaving us of any lengthy configuring that might have had to take place with any other system. Additionally, inqb8r were able to provide us with a licensed Wowza server.

LAMP server

\subsection{Programme recommendation}

To populate a users personal TV channel, your4.tv utilises a programme recommendation system. This system only recommends programmes, and is separate from the targetted advert retreiver (described in Section~\ref{sec:design_adverts}). At an abstract level, each programme is given a vector $\mathbf{p}$ within a programme space, $\mathcal{P}$, where the vector describes what the programme is like. The concrete implementation of this used in your4.tv is that $\mathcal{P}$ is 19-dimentional, where each dimention represents one of the genres:
\begin{center}
	\emph{\footnotesize{
		\begin{tabular}{c c c c c}
			Action and Adventure & Animation & Children & Comedy & Documentary \\
			Drama & Game Show & Home and Garden & Mini-Series & News \\
			Reality & Science-Fiction & Fantasy & Soap & Special Interest \\
			Sport & Talk Show & Western & Unclassified & 
		\end{tabular} 
	}}
\end{center}
where the genres belonging to a programme are pulled from the tvdb api\footnote{\url{http://thetvdb.com/wiki/index.php/Programmers_API}}. The 19 dimentions are made up of the 18 possible tvdb genres plus `Unclassified', which is reserved for programmes which do not appear in the tvdb api. The tvdb genres were used instead of the Project4 or Atlas genres, as no programme viewing data using Project4 or Atlas genres could be obtained, which would be required as training data for the recommender. Instead, all programmes (training and live) are given the genres listed by tvdb, allowing consistancy between live and training data.

Each programme has binary membership in one or more of the above genres (1 $\rightarrow$ belongs in genre; 0 $\rightarrow$ does not belong in genre), which makes up its vector in $\mathcal{P}$. As an example, the programme `Grand Designs' has genres \emph{Documentary}, \emph{Home and Garden} and \emph{Reality}, so would be assigned the vector:
\begin{center}
	$0,0,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0$
\end{center}

So that a user may be recommended programmes, a user is also given a vector within the space $\mathcal{P}$, which represents their ideal programme. The vector is initialised with the function \texttt{get\_user\_vector}, which, for user $i$, takes a vector of user demographic information, $\mathbf{d}_{i}$, and returns the user vector, $\mathbf{u}_{i}$, which exists within $\mathcal{P}$. The function \texttt{get\_user\_vector} is learned using a set of training data containing mappings between users, their demographics and shows they enjoy. While a user uses your4.tv, their actions influence their user vector. Upon giving a programme a rating, $\mathbf{u}$ is moved either towards or away from the $\mathbf{p}$ by an amount which depends upon the magnitude of the rating, the initial distance between $\mathbf{u}$ and $\mathbf{p}$, and the learning rate of the recommender which may be tweaked or made inversely proportional to the number of ratings made by the user.


% This genre-space implementation of $\mathcal{P}$ is not the only possible implementation. 


\subsection{Adverts}
\label{sec:design_adverts}

Adverts will be targetted

\subsubsection{Campaigns}

Data about users will be collected such that adverts may be targetted towards certain demographics:
\begin{enumerate}
\item \textit{Age range}
\item \textit{Gender}
\item \textit{Location}
\end{enumerate}

Additionally, an advertiser may specify \textit{when} adverts should appear:
\begin{enumerate}
\item \textit{Time of day}
\item \textit{Day of week}
\item \textit{Programme that is on}
\item \textit{Genre of programme that is on}
\end{enumerate}

\subsubsection{Viewer - consuming adverts}

\subsection{Streaming}
Each programme will be recorded using the EPG data. Since adverts will be replaced by ones recommended to viewers, it must be known when adverts are due to start and finish. This information is available as a GPI[?] pulse, sent by Channel 4 [more technical details]

- detail of stream origin and how many systems it goes through before reaching us
- detail about any delay this may cause
- what limitations are imposed by this? is useful data stripped? does the delay cause inaccuracies?

